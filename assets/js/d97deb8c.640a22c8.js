"use strict";(self.webpackChunkstsinc_docs=self.webpackChunkstsinc_docs||[]).push([[245],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>d});var n=r(7294);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,p=function(e,t){if(null==e)return{};var r,n,p={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(p[r]=e[r]);return p}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(p[r]=e[r])}return p}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},s=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},f=n.forwardRef((function(e,t){var r=e.components,p=e.mdxType,a=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),u=l(r),f=p,d=u["".concat(c,".").concat(f)]||u[f]||m[f]||a;return r?n.createElement(d,o(o({ref:t},s),{},{components:r})):n.createElement(d,o({ref:t},s))}));function d(e,t){var r=arguments,p=t&&t.mdxType;if("string"==typeof e||p){var a=r.length,o=new Array(a);o[0]=f;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[u]="string"==typeof e?e:p,o[1]=i;for(var l=2;l<a;l++)o[l]=r[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}f.displayName="MDXCreateElement"},8220:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>i,toc:()=>l});var n=r(7462),p=(r(7294),r(3905));const a={},o="**SocketIO \u600e\u4e48\u7528\uff1f**",i={unversionedId:"\u8fd0\u7ef4\u96c6\u6210/SocketIO\u600e\u4e48\u7528",id:"\u8fd0\u7ef4\u96c6\u6210/SocketIO\u600e\u4e48\u7528",title:"**SocketIO \u600e\u4e48\u7528\uff1f**",description:"\u524d\u63d0\u6761\u4ef6\uff1a",source:"@site/best-practice/30. \u8fd0\u7ef4\u96c6\u6210/30.SocketIO\u600e\u4e48\u7528.md",sourceDirName:"30. \u8fd0\u7ef4\u96c6\u6210",slug:"/\u8fd0\u7ef4\u96c6\u6210/SocketIO\u600e\u4e48\u7528",permalink:"/best-practice/\u8fd0\u7ef4\u96c6\u6210/SocketIO\u600e\u4e48\u7528",draft:!1,tags:[],version:"current",sidebarPosition:30,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u9644\u4ef6\u8f6c\u5b58\u5230NFS\u5b58\u50a8",permalink:"/best-practice/\u8fd0\u7ef4\u96c6\u6210/\u9644\u4ef6\u8f6c\u5b58\u5230NFS\u5b58\u50a8"},next:{title:"\u90ae\u7bb1\u914d\u7f6e",permalink:"/best-practice/\u8fd0\u7ef4\u96c6\u6210/\u90ae\u7bb1\u914d\u7f6e"}},c={},l=[{value:"\u524d\u63d0\u6761\u4ef6\uff1a",id:"\u524d\u63d0\u6761\u4ef6",level:2},{value:"\u7528\u6cd5\uff1a",id:"\u7528\u6cd5",level:2},{value:"\u65b9\u6cd51\uff1a \u786e\u8ba4\u8fde\u63a5\u53ef\u5de5\u4f5c",id:"\u65b9\u6cd51-\u786e\u8ba4\u8fde\u63a5\u53ef\u5de5\u4f5c",level:3}],s={toc:l},u="wrapper";function m(e){let{components:t,...r}=e;return(0,p.kt)(u,(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,p.kt)("h1",{id:"socketio-\u600e\u4e48\u7528"},(0,p.kt)("strong",{parentName:"h1"},"SocketIO \u600e\u4e48\u7528\uff1f")),(0,p.kt)("h2",{id:"\u524d\u63d0\u6761\u4ef6"},"\u524d\u63d0\u6761\u4ef6\uff1a"),(0,p.kt)("ol",null,(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u8fd9\u4e2asockeio\u8981\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c \u610f\u601d\u662f\u542f\u52a8\u5e76\u4e0d\u662fbench start \u542f\u52a8\u7684\u3002")),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u67e5\u770b\u5982\u4e0b\u7684\u914d\u7f6e\uff0c \u770b\u662f\u5426\u6709redis_socketio \u548c socketio_port"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre"},'frappe@e8811978c502:~/frappe-bench/sites$ cat common_site_config.json \n{\n "background_workers": 1,\n "developer_mode": 1,\n "dns_multitenant": false,\n "file_watcher_port": 6787,\n "frappe_user": "frappe",\n "gunicorn_workers": 5,\n "http_timeout": 6000,\n "live_reload": true,\n "maintenance_mode": 0,\n "no-cors": 1,\n "pause_scheduler": 0,\n "rebase_on_pull": false,\n "redis_cache": "redis://localhost:13000",\n "redis_queue": "redis://localhost:11000",\n "redis_socketio": "redis://localhost:12000",\n "restart_supervisor_on_update": true,\n "restart_systemd_on_update": false,\n "serve_default_site": true,\n "shallow_clone": true,\n "socketio_port": 9000,\n "use_redis_auth": false,\n "webserver_port": 8000\n}\n'))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u67e5\u770b\u8fdb\u7a0b\u662f\u5426\u6709\u5728\u8fd0\u884c\u3002"),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre"},"frappe@e8811978c502:~/frappe-bench/sites/site1.local$ sudo supervisorctl status all\nfrappe-bench-node-socketio                                  RUNNING   pid 57942, uptime 10:42:40\nfrappe-bench-redis:frappe-bench-redis-cache                 RUNNING   pid 57943, uptime 10:42:40\nfrappe-bench-redis:frappe-bench-redis-queue                 RUNNING   pid 57944, uptime 10:42:40\nfrappe-bench-redis:frappe-bench-redis-socketio              RUNNING   pid 57945, uptime 10:42:40\nfrappe-bench-web:frappe-bench-frappe-web                    RUNNING   pid 57946, uptime 10:42:40\nfrappe-bench-workers:frappe-bench-frappe-default-worker-0   RUNNING   pid 57953, uptime 10:42:40\nfrappe-bench-workers:frappe-bench-frappe-long-worker-0      RUNNING   pid 57968, uptime 10:42:40\nfrappe-bench-workers:frappe-bench-frappe-schedule           RUNNING   pid 57952, uptime 10:42:40\nfrappe-bench-workers:frappe-bench-frappe-short-worker-0     RUNNING   pid 57962, uptime 10:42:40\nmariadb                                                     RUNNING   pid 57941, uptime 10:42:40\nnginx                                                       RUNNING   pid 57969, uptime 10:42:40\nsshd                                                        FATAL     Exited too quickly (process log may have details)\n"))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u67e5\u770b\u4e00\u4e0b\u6d4f\u89c8\u5668\u8fd9\u91cc\u7684console\u662f\u5426\u6709\u62a5\u9519\u3002"),(0,p.kt)("p",{parentName:"li"},(0,p.kt)("img",{parentName:"p",src:"https://pic.imgdb.cn/item/656d0195c458853aeffa135b.jpg",alt:null}))),(0,p.kt)("li",{parentName:"ol"},(0,p.kt)("p",{parentName:"li"},"\u6700\u540e\u901a\u8fc7\u5982\u4e0b\u7684\u65b9\u6cd5\u6765\u786e\u8ba4socketio\u5de5\u4f5c\u6ca1\u6709\u95ee\u9898\u3002 "),(0,p.kt)("pre",{parentName:"li"},(0,p.kt)("code",{parentName:"pre"},'C:\\Users\\jianc>curl "http://192.168.32.2/socket.io/?EIO=4&transport=polling"\n0{"sid":"e2xXQht7jqCwrRihAACP","upgrades":["websocket"],"pingInterval":25000,"pingTimeout":20000,"maxPayload":1000000}\n')),(0,p.kt)("p",{parentName:"li"},"\u200b    "))),(0,p.kt)("h2",{id:"\u7528\u6cd5"},"\u7528\u6cd5\uff1a"),(0,p.kt)("p",null,"\u540e\u7eed\u7684\u8c03\u8bd5\uff0c \u5ba2\u6237\u7aef\u76f4\u63a5\u7528\u6d4f\u89c8\u5668\u7684\u63a7\u5236\u53f0\u5c31\u53ef\u4ee5\uff0c \u670d\u52a1\u7aef\u7528\u670d\u52a1\u5668\u7684bench console"),(0,p.kt)("p",null,"bench console\u7684\u8fdb\u5165\u65b9\u5f0f\uff1a"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'frappe@e8811978c502:~/frappe-bench$ bench use site1.local\nCurrent Site set to site1.local\nfrappe@e8811978c502:~/frappe-bench$ bench console\nApps in this namespace:\nfrappe, erpnext, erpnextcn, meeting\n\nIn [1]: frappe.publish_realtime("custom_event")\n')),(0,p.kt)("h3",{id:"\u65b9\u6cd51-\u786e\u8ba4\u8fde\u63a5\u53ef\u5de5\u4f5c"},"\u65b9\u6cd51\uff1a \u786e\u8ba4\u8fde\u63a5\u53ef\u5de5\u4f5c"),(0,p.kt)("pre",null,(0,p.kt)("code",{parentName:"pre"},'client:\nfrappe.realtime.on("custom_event",() => { console.log("Hello,call from back.")});\n\nserver:\nfrappe.publish_realtime("custom_event")\n')),(0,p.kt)("p",null,"\u670d\u52a1\u7aef\u53d1\u9001\u5b8c\u4e4b\u540e\uff0c \u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u7684\u63a7\u5236\u53f0\u5f97\u5230\u8f93\u51fa\u3002"),(0,p.kt)("p",null,(0,p.kt)("img",{parentName:"p",src:"https://pic.imgdb.cn/item/656d0303c458853aeffbc1ab.jpg",alt:null})))}m.isMDXComponent=!0}}]);