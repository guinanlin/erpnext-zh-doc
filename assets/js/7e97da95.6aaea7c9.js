"use strict";(self.webpackChunkstsinc_docs=self.webpackChunkstsinc_docs||[]).push([[217],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>d});var n=o(7294);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(o),m=r,d=c["".concat(l,".").concat(m)]||c[m]||h[m]||a;return o?n.createElement(d,i(i({ref:t},u),{},{components:o})):n.createElement(d,i({ref:t},u))}));function d(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=o.length,i=new Array(a);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=o[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}m.displayName="MDXCreateElement"},9613:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var n=o(7462),r=(o(7294),o(3905));const a={},i="\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",s={unversionedId:"\u8d22\u52a1/\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",id:"\u8d22\u52a1/\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",title:"\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",description:"Hi John,",source:"@site/best-practice/100. \u8d22\u52a1/20. \u81ea\u5b9a\u4e49\u635f\u76ca\u8868.md",sourceDirName:"100. \u8d22\u52a1",slug:"/\u8d22\u52a1/\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",permalink:"/best-practice/\u8d22\u52a1/\u81ea\u5b9a\u4e49\u635f\u76ca\u8868",draft:!1,tags:[],version:"current",sidebarPosition:20,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\u53d1\u7968\u91d1\u989d\u7684\u56db\u820d\u4e94\u5165\u5904\u7406",permalink:"/best-practice/\u8d22\u52a1/\u53d1\u7968\u91d1\u989d\u7684\u56db\u820d\u4e94\u5165\u5904\u7406"},next:{title:"\u5982\u4f55\u5904\u7406\u9500\u552e\u9884\u6536\u6b3e\u95ee\u9898",permalink:"/best-practice/\u8d22\u52a1/\u5982\u4f55\u5904\u7406\u9500\u552e\u8ba2\u5355\u9884\u6536\u6b3e"}},l={},p=[],u={toc:p},c="wrapper";function h(e){let{components:t,...o}=e;return(0,r.kt)(c,(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"\u81ea\u5b9a\u4e49\u635f\u76ca\u8868"},"\u81ea\u5b9a\u4e49\u635f\u76ca\u8868"),(0,r.kt)("h1",{id:"custom-pl-report"},(0,r.kt)("a",{parentName:"h1",href:"https://discuss.frappe.io/t/custom-p-l-report/80143"},"Custom P&L report")),(0,r.kt)("p",null,"Hi John,"),(0,r.kt)("p",null,"I don\u2019t have easy solutions to offer. But I\u2019ll share some info and advice."),(0,r.kt)("p",null,"Unlike other ERPs I\u2019ve worked in, ERPNext\u2019s accounting reports are not very \u201cconfigurable\u201d. There\u2019s no place to specify exactly how your ",(0,r.kt)("strong",{parentName:"p"},"Profit and Loss Statement")," should look and work. For example, which GL accounts to include/exclude, show in another section, combine with other accounts, etc."),(0,r.kt)("p",null,"Instead, the P&L Statement Report in ERPNext follows the Chart of Accounts structure rather precisely. To move things around the report, you probably must modify the COA. However, if you modify the COA\u2026that could change how the ERP behaves in terms of validation and posting! "),(0,r.kt)("p",null,"Next challenge: The P&L statement is one of the more complex reports in ERPNext. It\u2019s a \u201c",(0,r.kt)("a",{parentName:"p",href:"https://frappeframework.com/docs/user/en/desk/reports/script-report"},"Script Report 4"),"\u201d, and has quite a lot of Python code behind it."),(0,r.kt)("p",null,"If you haven\u2019t found it already, the path to the P&L Script Report\u2019s code is ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/frappe/erpnext/blob/version-12/erpnext/accounts/report/profit_and_loss_statement/profit_and_loss_statement.py"},"here. 16")),(0,r.kt)("p",null,"However, during execution, that code in turn calls ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/frappe/erpnext/blob/version-12/erpnext/accounts/report/financial_statements.py"},(0,r.kt)("em",{parentName:"a"},"other code")," 2"),". Which is very relevant to the report\u2019s output. There\u2019s a lot going on, and plenty of Python to decipher, to understand how it all works. !"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Options I can think of:")),(0,r.kt)("hr",null),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Option 1.")," Attempt to modify the report\u2019s Python code."),(0,r.kt)("p",null,"Tricky stuff. You possibly only need to add a line or two of Python, filtering out Account 5118. But like a lot of hacking, sometimes the challenge isn\u2019t knowing ",(0,r.kt)("em",{parentName:"p"},"what")," code to write. But ",(0,r.kt)("em",{parentName:"p"},"where")," to write it. In other words, you need to hide 5118 carefully, so that P&L totals and roll-ups are accurate when you\u2019re done."),(0,r.kt)("p",null,"The question of whether to touch/not-touch core code is worth another thread/discussion. But most likely, you probably want to -copy- the standard script report, and make your own, cloned version. That way you don\u2019t have to worry about maintaining a fork."),(0,r.kt)("p",null,"If you\u2019ve never created your own Script Report before? Well, this is probably one of the ",(0,r.kt)("em",{parentName:"p"},"worst")," ones to learn from, because it\u2019s complex. I recommend you experiment with something easier, to help you learn them."),(0,r.kt)("hr",null),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Option 2.")," Write your own version using a Query Report."),(0,r.kt)("p",null,"One of the reasons the ",(0,r.kt)("strong",{parentName:"p"},"Profit and Loss Statement")," has so much Python code? Because it\u2019s a \u201c",(0,r.kt)("em",{parentName:"p"},"one-size-fits-all"),"\u201d report solution. It has filters for Finance Books, Projects, Cost Centers, Year vs. Month vs. Quarter, currency, etc. It\u2019s a ",(0,r.kt)("em",{parentName:"p"},"lot")," to handle."),(0,r.kt)("p",null,"Your own business may not need all those options. Or at least not simultaneously. If you take them away, and focus on P&L fundamentals, the data and logic behind the report becomes ",(0,r.kt)("em",{parentName:"p"},"much")," simpler to grasp and manipulate."),(0,r.kt)("p",null,"So simple, in fact, that you can probably create your own ",(0,r.kt)("strong",{parentName:"p"},"Query Report")," that produces the same results. But enables you to more-easily filter out particular accounts, or move things around."),(0,r.kt)("p",null,"Query Reports rely on writing SQL queries. A P&L Statement requires only a few Tables. At a minimum:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"General Ledger activity: ",(0,r.kt)("inlineCode",{parentName:"li"},"'tabGL Entry'")),(0,r.kt)("li",{parentName:"ul"},"Chart of Accounts structure: ",(0,r.kt)("inlineCode",{parentName:"li"},"'tabAccount'"))),(0,r.kt)("p",null,"If you\u2019re proficient with SQL, you could construct your own query that produces P&L data. Then display that in ERPNext through the Query Report. You could think about using SQL Common Table Expressions to handle the hierarchy. Or just create a bunch of SQL queries and ",(0,r.kt)("inlineCode",{parentName:"p"},"UNION")," them together. There are tons of possibilities."),(0,r.kt)("p",null,"Advantage: You haven\u2019t changed a single line of ERPNext code. And you can make the P&L statement look exactly how you want."),(0,r.kt)("p",null,"Disadvantage: Reinventing the wheel, from a certain point of view. Requires SQL expertise."),(0,r.kt)("hr",null),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Option 3.")," Excel or Google Docs spreadsheet."),(0,r.kt)("p",null,"All your General Ledger activity resides in SQL table ",(0,r.kt)("inlineCode",{parentName:"p"},"'tabGL Entry'"),". If you\u2019re a spreadsheet guru, you could construct your P&L report as a spreadsheet. Put the results on Worksheet 1, the logic in Worksheet 2, and the raw GL data in Worksheet 3. Just dump your GL data out of ERPNext into your spreadsheet, and refresh."),(0,r.kt)("p",null,"Also, this may be nice for your Accountants:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Most are comfortable working in spreadsheets."),(0,r.kt)("li",{parentName:"ol"},"Many enjoy having direct access to the data, to munge it, handle exceptions, re-group data, etc.")),(0,r.kt)("p",null,"Are your accountants ultimately taking the ERPNext P&L report, and just exporting to Excel anyway? If so, you could skip a step. By creating the P&L report as Excel in the first place."),(0,r.kt)("p",null,"You might encounter issues with size and volume. Importing hundreds of thousands of GL transactions into a spreadsheet is not ideal. But people do this all the time. I\u2019m not a huge fan of Excel, personally. Yet sometimes it\u2019s the path of least resistance."),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Option 4. Third Party Software."),(0,r.kt)("p",null,"This is a ",(0,r.kt)("em",{parentName:"p"},"much")," longer-term idea and solution. But since we\u2019re talking about reporting, here\u2019s my take on this:"),(0,r.kt)("p",null,"In many ways, ERPNext is a generalist. A ",(0,r.kt)("a",{parentName:"p",href:"https://idioms.thefreedictionary.com/jack+of+all+trades"},"\u201cjack of all trades\u201d 4"),". It\u2019s good at many tasks. But not necessarily \u201cgreat\u201d."),(0,r.kt)("p",null,"To really get the ",(0,r.kt)("em",{parentName:"p"},"most")," value from your data, I would consider using specialty reporting tools. Whether something like Microsoft Power BI, or Solver\u2019s financial reporting tools. Or one of ",(0,r.kt)("em",{parentName:"p"},"hundreds")," of other possibilities. But there are definitely Reporting Tools that focus on just that: reporting. Or even Reporting Tools that focus on ",(0,r.kt)("em",{parentName:"p"},"Financial")," Reporting."),(0,r.kt)("p",null,"You can find things with drag & drop widgets, built-in data mining and trend analysis, and so much more."),(0,r.kt)("p",null,"I am ",(0,r.kt)("em",{parentName:"p"},"-not-")," suggesting you reach for this option today. Sounds like you just need a quick fix. But if your career involves working with ERP\u2019s long term? Definitely something to think about."),(0,r.kt)("p",null,"Hope some of the info above helps. You\u2019re doing well; keep it up! As someone who \u201cstarted at the bottom\u201d with ERPNext, and learned most of its technology from scratch, I definitely empathize with you. ","![:slight_smile:]","(",(0,r.kt)("a",{parentName:"p",href:"https://discuss.frappe.io/images/emoji/twitter/slight_smile.png?v=12"},"https://discuss.frappe.io/images/emoji/twitter/slight_smile.png?v=12")),(0,r.kt)("p",null,"~Brian"))}h.isMDXComponent=!0}}]);